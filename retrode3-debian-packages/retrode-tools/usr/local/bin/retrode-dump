#!/bin/bash -p
# retrode-dump slot - dump cart header

case "$1" in
	headers )
		if xxd -l 1 /dev/slot-md >/dev/null 2>&1
		then
			echo MD header:
			xxd -s 256 -l 256 /dev/slot-md
		else
			echo MD slot empty
		fi

		if xxd -l 1 /dev/slot-snes >/dev/null 2>&1
		then
			echo "SNES LoROM header:"
			xxd -s 0x7fc0 -l 0x20 /dev/slot-snes
			echo "SNES HiROM header:"
			xxd -s 0xffc0 -l 0x20 /dev/slot-snes
		else
			echo SNES slot empty
		fi

		if xxd -l 1 /dev/slot-nes >/dev/null 2>&1
		then
			echo "NES PRG:"
			# 0x0a00 is NES_PRG
			xxd -s 0x0a008000 -l 0x20 /dev/slot-nes

			# other read modes?
		else
			echo NES slot empty
		fi
		
		;;
	* )
		echo unknown command "$1"
		exit 1
		;;
esac
