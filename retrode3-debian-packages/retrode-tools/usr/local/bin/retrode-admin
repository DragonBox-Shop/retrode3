#!/bin/bash -p
# retrode-admin cmd - system admin tasks

# Fehlerbehandlung nach PHP verschieben?

set -e

case "$1" in
	poweroff )
		shift
		poweroff && echo Will power off now... || echo failed.
		;;
	apt-get-update )
		apt-get update && apt-get upgrade &&
			echo System updated. Now rebooting... &&
			reboot || echo failed.
		;;
	update-database )
		wget -qO /tmp/cart_reader.zip https://codeload.github.com/sanni/cartreader/zip/refs/heads/master &&
			unzip -q /tmp/cart_reader.zip 'cartreader-master/sd/*' -d /tmp/$$ &&
			mv -f /tmp/$$/cartreader-master/sd/* /usr/local/games/retrode &&
			echo Cart database updated. || echo Update failed.
		;;
	* )
		echo unknown command "$1"
		exit 1
		;;
esac
